
import streamlit as st
import openai

# ุฅุนุฏุงุฏ ููุชุงุญ OpenAI ูู Streamlit secrets
openai.api_key = st.secrets["OPENAI_API_KEY"]

st.set_page_config(page_title="ุณุชุงูู ุจูุช - ููุง", page_icon="๐")

st.title("๐ ุณุชุงูู ุจูุช - ููุง")
st.markdown("**ุงุญุตูู ุนูู ุชูุตูุงุช ูุจุณู ุงููุซุงูู ุจุงุณุชุฎุฏุงู ุงูุฐูุงุก ุงูุงุตุทูุงุนู!**")

ุฃููุงู_ุงูุจุดุฑุฉ = ['ูุงุชุญ', 'ููุญู', 'ุญูุทู', 'ุบุงูู']
ุงูุฃุทูุงู = ['ุฃูู ูู 150 ุณู', '150 - 165 ุณู', 'ุฃุทูู ูู 165 ุณู']
ุฃุดูุงู_ุงูุฌุณู = ['ูุณุชุทูู', 'ููุซุฑู', 'ุชูุงุญุฉ', 'ุณุงุนุฉ ุฑูููุฉ']
ุงูููุงุณุจุงุช = ['ุณูุฑุฉ', 'ุฒูุงุฌ ูุณุงุก', 'ูุดูุงุฑ ููุงุฑู', 'ุงูุนูู']

ููู_ุงูุจุดุฑุฉ = st.selectbox("๐ธ ููู ุงูุจุดุฑุฉ:", ุฃููุงู_ุงูุจุดุฑุฉ)
ุงูุทูู = st.selectbox("๐ ุงูุทูู:", ุงูุฃุทูุงู)
ุดูู_ุงูุฌุณู = st.selectbox("๐ ุดูู ุงูุฌุณู:", ุฃุดูุงู_ุงูุฌุณู)
ุงูููุงุณุจุฉ = st.selectbox("๐ ููุน ุงูููุงุณุจุฉ:", ุงูููุงุณุจุงุช)

if st.button("ุงุญุตูู ุนูู ุชูุตูุชู"):
    with st.spinner("ุฌุงุฑู ุงูุชูููุฑ... ๐ญ"):
        prompt = f'''
        ุจูุงุกู ุนูู ุงููุนูููุงุช ุงูุชุงููุฉ:
        - ููู ุงูุจุดุฑุฉ: {ููู_ุงูุจุดุฑุฉ}
        - ุงูุทูู: {ุงูุทูู}
        - ุดูู ุงูุฌุณู: {ุดูู_ุงูุฌุณู}
        - ููุน ุงูููุงุณุจุฉ: {ุงูููุงุณุจุฉ}

        ุงูุชุฑุญ ููู ูุงูู ูุดูู:
        - ููุน ุงููุจุณ ุงูููุงุณุจ
        - ุงูุฃููุงู ุงููุซุงููุฉ
        - ุชุณุฑูุญุฉ ุดุนุฑ
        - ุฃูุณุณูุงุฑุงุช ููุชุฑุญุฉ

        ุจุฃุณููุจ ุฃูุซูู ูุงุนู ูุจุงููุบุฉ ุงูุนุฑุจูุฉ.
        '''

        try:
            response = openai.ChatCompletion.create(
                model="gpt-4o",
                messages=[
                    {"role": "system", "content": "ุฃูุชู ุฎุจูุฑุฉ ููุถุฉ ุชูุฏููู ูุตุงุฆุญ ุฃูุซููุฉ ุจุงููุบุฉ ุงูุนุฑุจูุฉ."},
                    {"role": "user", "content": prompt}
                ],
                temperature=0.8,
                max_tokens=600
            )

            reply = response['choices'][0]['message']['content']
            st.success("โจ ุชูุตูุชู ุงูุฃูููุฉ:")
            st.write(reply)

        except Exception as e:
            st.error("ุญุฏุซ ุฎุทุฃ ุฃุซูุงุก ุงูุชูุงุตู ูุน ุงูุฐูุงุก ุงูุงุตุทูุงุนู.")
            st.code(str(e))
